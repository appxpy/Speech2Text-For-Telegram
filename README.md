# Speech2Text Бот для Telegram  

## Содержание
- [Speech2Text Бот для Telegram](#speech2text-бот-для-telegram)
  - [Содержание](#содержание)
  - [Описание](#описание)
    - [Структура проекта](#структура-проекта)

## Описание
Бывало ли у вас такое, что вам отправили голосовое сообщение в телеграме, а вы не можете его послушать? У телеграма уже есть встроенное решение для распознавания текста, но оно доступно только обладателям платных аккаунтов. Этот бот позволяет вам распознать голосовое сообщение и получить его текстовую расшифровку совершенно бесплатно!

### Структура проекта

- **Python 3.5+**

  Почему именно эту версию? Потому что в нем есть библиотеки asyncio и aiohttp, которые позволяют сделать бота асинхронным. Так как сервис на вебхуках, то он одновременно и HTTP-сервер и HTTP-клиент, а что для этого использовать, как не aiohttp; 

- **Webhook**

  Телеграм поддерживает только вебхуки, поэтому бот должен быть HTTP-сервером. Вебхуки позволяют получать сообщения от телеграма в режиме реального времени, а не постоянно опрашивать сервер телеграма.

<!-- - Decrypt HTTPS to HTTP

  Телеграм поддерживает только HTTPS, но вебхуки должны быть HTTP. Для этого используется библиотека nginx, которая позволяет создать HTTPS-сервер, который перенаправляет запросы на HTTP-сервер. -->

- **Database**
  
  Для хранения данных о пользователях используется база данных PostgreSQL. Для работы с ней используется библиотека aiopg. Так нужна для кэширования данных о пользователях, чтобы не делать лишних запросов к Yandex SpeechKit.

- **Yandex Speechkit**

  Для распознавания голосовых сообщений используется сервис Yandex SpeechKit. Клиент отправляет голосовое или видео сообщение, а сервис возвращает текстовую расшифровку(**с пунктуацией**). Для работы с ним используется библиотека speechkit и aiohttp.

- **Ассинхронный API Wrapper for Yandex Speechkit**

  Для удобства работы с API телеграма и Yandex SpeechKit был написан ассинхронный Wrapper для библиотеки speechkit. Он позволяет отправлять запросы к API и получать ответы в виде объектов, а не в виде JSON-строк. Для достижения такого результата была использована библиотека pydantic.

- **Пунктуация**

  Для добавления пунктуации в расшифровку аудио-сообщения используется библиотека **aiohttp**, которая отправляет запрос на сайт [textovod.ru](https://textovod.ru), где расшифровка голосового сообщения обрабатывается и возвращается с пунктуацией.

- **Docker**

  Для удобства развертывания и запуска бота используется Docker. Все зависимости устанавливаются в контейнере, а для запуска используется docker-compose.

---